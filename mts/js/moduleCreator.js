"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}!function(e){e.CreateModule=function(){var t,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"run",value:function(){t.props=n,t.extendProps(),t.makeLib()}},{key:"getCamelCase",value:function(e){return e.substr(0,1).toLowerCase()+e.substr(1)}},{key:"makeLib",value:function(){(e=e||{}).fn=e.fn||{},e[s]=e[s]?e[s]:e.fn[s]=function(){var t=this;"function"==typeof t&&(t=e[s].element||e("<div>"),e[s].element=t);for(var n=arguments[0],r=Array.prototype.slice.call(arguments,1),o=t,a=0;a<t.length;a++){var i=t[a];if("object"===_typeof(n)||void 0===n){if("object"!==_typeof(i[s])){var u=new h(i,n);u.list[u.hash]=u}}else{if(!i[s][n]||"function"!=typeof i[s][n])throw new Error('Method "'+n+'" is not defined in the "'+s+'" module');o=i[s][n].apply(i[s],r)||t}}return o},e[s].struct=n}},{key:"extendProps",value:function(){if(n.extends&&0<n.extends.length){t.parents={},t.parent={};var r=n.extends.map((function(n){n=t.getCamelCase(n);var r=e[n].struct;return t.parents[n]=r.privateMethods,r}));t.parentMethods=t.extend.apply(t,[{}].concat(_toConsumableArray(r))).privateMethods,n.parents=t.parents,n=t.extend.apply(t,[{}].concat(_toConsumableArray(r),[n]))}}},{key:"extend",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length,r=new Array(1<n?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.map((function(n){for(var r in n)if(n.hasOwnProperty(r)){var o=n[r];if("function"==typeof o)e[r]=o;else if(Array.isArray(o))e[r]=t.deepCopy(o);else if("object"===_typeof(o)){var a;a=Array.isArray(e[r])?t.extend({},o):"object"===_typeof(e[r])?t.extend(e[r],o):t.extend({},o),e[r]=a}else e[r]=o}})),e}},{key:"deepCopy",value:function(e){if("function"==typeof e)return e;if(Array.isArray(e))return e.map((function(e){return t.deepCopy(e)}));if("object"!==_typeof(e))return e;var n=t.extend({},e);for(var r in n)n.hasOwnProperty(r)&&(n[r]=t.deepCopy(n[r]));return n}},{key:"haveFunctions",value:function(e){for(var t in e)if(e.hasOwnProperty(t)&&"function"!=typeof e[t])throw new Error('The "'+t+'" element must be a function')}}]),t}(),o=function(){function e(t,n,r){_classCallCheck(this,e),this.inst=t,this.watch=r,this.data={},this.instData=n,this.setData(n)}return _createClass(e,[{key:"setData",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};for(var n in t)t.hasOwnProperty(n)&&this.set(n,t[n],this.watch[n]);Object.defineProperty(this.inst,"data",{get:function(){return e.instData}})}},{key:"set",value:function(e,t,n){var r=this;Object.defineProperty(this.instData,e,{get:function(){return r.data[e]},set:function(t){var o=r.data[e];r.data[e]=t,n&&"function"==typeof n?n.call(r.inst,o,r.data[e]):r.watch[e]&&"function"==typeof r.watch[e]&&r.watch[e].call(r.inst,o,r.data[e])}}),r.data[e]=t}}]),e}(),a=function(){function e(t,n){_classCallCheck(this,e),this.privateMethods={},this.options=n,this.globalReg(t),this.addHooks(t),this.addSuperMethods(t),this.addPrivateMethods(t),this.addPublicMethods(t),this.setData(t),this.setOptions(t)}return _createClass(e,[{key:"globalReg",value:function(e){var t={storage:c,list:u},n=function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){throw new Error('Setting the value to "'+e+'" failed. Object "'+n+'" is not editable')}})};for(var r in t)n(r)}},{key:"setData",value:function(e){var a=r.extend({},n.data||{},this.options.data||{}),i=r.extend({},n.watch||{},this.options.watch||{});r.haveFunctions(i),t=new o(e,a,i)}},{key:"setOptions",value:function(e){var t=Math.round(new Date*Math.random()),o=e.el.dataset,a=o[s],i={},u={};if(0<Object.keys(o).length)for(var c in o)if(c!==s&&0===c.indexOf(s)&&o.hasOwnProperty(c)){var h=r.getCamelCase(c.split(s)[1]);try{u[h]=""===o[c]||JSON.parse(o[c])}catch(e){u[h]=o[c]}}try{i=a?JSON.parse(a):{}}catch(e){throw new Error("Check the data attributes in the element. "+a+" is not valid JSON format.")}e.hash=e.el.hash=t;var f=r.extend({},n.options||{},this.options.options||{},i,u,{hash:t}),l={},d=function(t){f.hasOwnProperty(t)&&Object.defineProperty(l,t,{set:function(e){f[t]=e},get:function(){return e._getOption(f,t)}})};for(var p in f)d(p);Object.defineProperty(e,"options",{get:function(){return l}})}},{key:"addHooks",value:function(e){var t=r.extend({beforeCreate:function(){},bindEvent:function(){},afterCreate:function(){}},n.hooks||{},this.options.hooks||{});r.haveFunctions(t),Object.defineProperty(e,"hook",{get:function(){return function(n){if(!t[n])throw new Error('Hook "'+n+'" is not defined in the module');for(var r=arguments.length,o=new Array(1<r?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];return t[n].apply(e,o)}}})}},{key:"addPrivateMethods",value:function(e){if(n.privateMethods)for(var t in r.haveFunctions(n.privateMethods),n.privateMethods)if(n.privateMethods.hasOwnProperty(t)){if("_"!==t[0])throw new Error('The name of the private method must begin with "_". Rename the method '+t);e[t]=this.privateMethods[t]=n.privateMethods[t].bind(e)}}},{key:"addPublicMethods",value:function(e){var t=this;if(e.el[s]={data:e.data,getStruct:function(){return e._getStruct()},destroy:function(){return e._destroy()}},n.publicMethods)for(var o in r.haveFunctions(n.publicMethods),n.publicMethods)if(n.publicMethods.hasOwnProperty(o)){var a={};if(Object.defineProperty(a,"inst",{get:function(){return e.el[s]}}),Object.defineProperty(a,"private",{get:function(){return t.privateMethods},set:function(e){throw new Error('Setting the value to "'+e+'" failed. Object "private" is not editable')}}),e.el[s][o]=n.publicMethods[o].bind(a),e[o])throw new Error("The "+o+" method is already defined in a private scope!");if("_"===o[0])throw new Error('The public method should not start with "_". Rename the method '+o)}}},{key:"addSuperMethods",value:function(e,t){r.extend(e.__proto__,r.parentMethods),Object.defineProperty(e,"super",{get:function(){return function(t,r){try{for(var o=arguments.length,a=new Array(2<o?o-2:0),i=2;i<o;i++)a[i-2]=arguments[i];return n.parents&&"object"===_typeof(n.parents[t])&&n.parents[t][r]?n.parents[t][r].apply(this,a):e.__proto__[t].apply(this,[r].concat(a))}catch(r){throw new Error('Method "'+t+'" is not defined in the parents modules')}}}})}}]),e}(),i=n.name,s=r.getCamelCase(i),u={},c={};r.run();var h=function(){function n(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,n);var o=this;o.element=e(t),1<o.element.length?o.element.map((function(t){return new e[i](t,r)})):(o.el=t,new a(o,r),o.hook("beforeCreate"),o.hook("create"),o.hook("bindEvent"),o.hook("afterCreate"))}return _createClass(n,[{key:"_set",value:function(e,n,r){t.set(e,n,r)}},{key:"_getEventList",value:function(){return{click:"touchend",mouseenter:"touchstart",mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove",mouseleave:"touchend"}}},{key:"_getEventName",value:function(e,t){return t=(t?"."+t:"")+"."+this.hash,this._isMobile()?(this._getEventList()[e]||e)+t:e+t}},{key:"_isMobile",value:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}},{key:"_destroy",value:function(){delete this.list[this.hash],delete this.el.hash,delete this.el[s]}},{key:"_getOption",value:function(e,t){return e[t]}},{key:"_extend",value:function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length,n=new Array(1<t?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return r.extend.apply(r,[e].concat(n))}},{key:"_deepCopy",value:function(e){return r.deepCopy(e)}}]),n}()}}(jQuery);